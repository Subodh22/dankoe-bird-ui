<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Dankoe Bird</title>
    <style>
      :root {
        color-scheme: dark;
        --bg: #0b0c10;
        --panel: #10131a;
        --panel-strong: #0f141c;
        --border: #1f2530;
        --text: #e5e7eb;
        --muted: #9aa4b2;
        --accent: #88a3ff;
        --accent-strong: #a5b4ff;
        --success: #6ee7b7;
        --danger: #fca5a5;
      }
      body {
        font-family: "Inter", "SF Pro Text", "Segoe UI", Arial, sans-serif;
        margin: 0;
        color: var(--text);
        background: radial-gradient(circle at top, #111827 0%, #0b0c10 45%, #0b0c10 100%);
      }
      .page {
        max-width: 1100px;
        margin: 0 auto;
        padding: 32px 24px 64px;
      }
      h1 {
        margin: 0 0 6px;
        font-size: 28px;
        letter-spacing: 0.4px;
      }
      h2 {
        margin: 0 0 12px;
        font-size: 18px;
        font-weight: 600;
        color: var(--text);
      }
      .subtitle {
        color: var(--muted);
        font-size: 14px;
        max-width: 720px;
      }
      .top-bar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding-bottom: 24px;
        border-bottom: 1px solid var(--border);
        margin-bottom: 24px;
      }
      .brand {
        display: flex;
        flex-direction: column;
        gap: 6px;
      }
      .card {
        border: 1px solid var(--border);
        border-radius: 14px;
        padding: 18px;
        margin-bottom: 16px;
        background: linear-gradient(160deg, #0f141d, #0b0c10);
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      }
      .tabs {
        display: inline-flex;
        gap: 8px;
        padding: 6px;
        border: 1px solid var(--border);
        border-radius: 999px;
        background: var(--panel);
      }
      .tab-button {
        padding: 6px 14px;
        border-radius: 999px;
        border: 1px solid transparent;
        background: transparent;
        color: var(--muted);
        font-weight: 600;
        cursor: pointer;
      }
      .tab-button.active {
        color: var(--text);
        border-color: var(--border);
        background: var(--panel-strong);
      }
      .grid {
        display: grid;
        gap: 12px;
        grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      }
      .card-mini {
        border: 1px solid var(--border);
        border-radius: 12px;
        padding: 14px;
        background: var(--panel);
        display: flex;
        flex-direction: column;
        gap: 8px;
      }
      .card-mini strong {
        font-size: 16px;
      }
      .metric {
        font-size: 13px;
        color: var(--muted);
      }
      .script-output {
        white-space: pre-wrap;
      }
      .card-mini button {
        width: fit-content;
      }
      .row {
        display: flex;
        gap: 12px;
        flex-wrap: wrap;
        align-items: center;
      }
      .pagination {
        display: flex;
        align-items: center;
        justify-content: space-between;
        gap: 12px;
        margin-top: 12px;
      }
      .page-info {
        color: var(--muted);
        font-size: 13px;
      }
      .form-row {
        display: flex;
        flex-wrap: wrap;
        gap: 12px;
        align-items: center;
      }
      label {
        font-weight: 500;
        margin-right: 6px;
        color: var(--muted);
      }
      input[type="text"],
      input[type="number"],
      textarea,
      select {
        padding: 10px 12px;
        border: 1px solid var(--border);
        border-radius: 10px;
        min-width: 220px;
        background: var(--panel-strong);
        color: var(--text);
        outline: none;
        transition: border-color 0.2s ease, box-shadow 0.2s ease;
      }
      input:focus,
      textarea:focus,
      select:focus {
        border-color: var(--accent);
        box-shadow: 0 0 0 2px rgba(136, 163, 255, 0.2);
      }
      textarea {
        min-width: 360px;
        min-height: 120px;
        resize: vertical;
      }
      button {
        padding: 10px 18px;
        border-radius: 12px;
        border: none;
        background: linear-gradient(135deg, #7f93ff, #9aa9ff);
        color: #0b0c10;
        font-weight: 600;
        cursor: pointer;
        transition: transform 0.15s ease, box-shadow 0.15s ease;
      }
      button:hover {
        transform: translateY(-1px);
        box-shadow: 0 8px 24px rgba(136, 163, 255, 0.2);
      }
      button:disabled {
        background: #3b4252;
        color: #9aa4b2;
        cursor: not-allowed;
        box-shadow: none;
        transform: none;
      }
      .secondary {
        background: transparent;
        color: var(--text);
        border: 1px solid var(--border);
        box-shadow: none;
      }
      .secondary:hover {
        box-shadow: 0 8px 24px rgba(15, 23, 42, 0.35);
      }
      table {
        width: 100%;
        border-collapse: collapse;
        background: var(--panel);
        border-radius: 12px;
        overflow: hidden;
      }
      th,
      td {
        text-align: left;
        padding: 12px 14px;
        border-bottom: 1px solid var(--border);
        vertical-align: top;
      }
      th {
        background: #0f172a;
        color: var(--muted);
        font-size: 12px;
        text-transform: uppercase;
        letter-spacing: 0.08em;
      }
      tbody tr:hover {
        background: rgba(136, 163, 255, 0.08);
      }
      .status {
        margin: 16px 0;
        font-size: 0.95rem;
        color: var(--muted);
        display: inline-flex;
        align-items: center;
        gap: 8px;
      }
      .spinner {
        width: 14px;
        height: 14px;
        border: 2px solid rgba(136, 163, 255, 0.25);
        border-top-color: var(--accent);
        border-radius: 999px;
        animation: spin 0.8s linear infinite;
      }
      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }
      .muted {
        color: var(--muted);
      }
      .helper {
        font-size: 12px;
        color: var(--muted);
        margin-top: 6px;
      }
      .text-cell {
        max-width: 520px;
        white-space: pre-wrap;
      }
      .media-thumbs {
        display: flex;
        gap: 8px;
        flex-wrap: wrap;
        margin-top: 8px;
      }
      .media-thumbs img {
        width: 96px;
        height: 96px;
        object-fit: cover;
        border-radius: 10px;
        border: 1px solid var(--border);
      }
      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="page">
      <div class="top-bar">
        <div class="brand">
          <h1>Dankoe Bird</h1>
          <p class="subtitle">
            Quiet analysis for loud timelines. Fetch, filter, and surface the most signal-rich posts.
          </p>
        </div>
        <div class="tabs" role="tablist">
          <button class="tab-button active" id="tab-analyze" type="button">Analyze</button>
          <button class="tab-button" id="tab-history" type="button">History</button>
          <button class="tab-button" id="tab-handles" type="button">Handles</button>
          <button class="tab-button" id="tab-bird" type="button">Bird</button>
          <button class="tab-button" id="tab-foryou" type="button">For You</button>
          <button class="tab-button" id="tab-script" type="button">Script</button>
        </div>
      </div>

      <section id="analyze-view">
        <div class="card">
          <h2>Search</h2>
          <form id="search-form" class="form-row">
            <div>
              <label for="search-query">Query</label>
              <input id="search-query" type="text" placeholder="from:steipete OR keyword" required />
              <div class="helper">Search the live feed by query syntax.</div>
            </div>
            <div>
              <label for="search-count">Count</label>
              <input id="search-count" type="number" min="1" max="100" value="20" />
            </div>
            <button id="search-button" type="submit">Run Search</button>
          </form>
        </div>

        <div class="card">
          <h2>User Timeline</h2>
          <form id="user-form" class="form-row">
            <div>
              <label for="user-handle">Handle</label>
              <input id="user-handle" type="text" placeholder="@steipete" required />
              <div class="helper">Quick scan of a single profile.</div>
            </div>
            <div>
              <label for="user-count">Count</label>
              <input id="user-count" type="number" min="1" max="100" value="20" />
            </div>
            <button id="user-button" type="submit">Fetch Tweets</button>
          </form>
        </div>

        <div class="card">
          <h2>Analyze</h2>
          <form id="analyze-form" class="form-row">
            <div>
              <label for="analyze-mode">Mode</label>
              <select id="analyze-mode">
                <option value="fetch">Fetch</option>
                <option value="outliers">Outliers</option>
                <option value="matrix">Matrix</option>
              </select>
              <div class="helper">Choose how to analyze your cached handles.</div>
            </div>
            <div>
              <label for="analyze-handles">Handles</label>
              <textarea id="analyze-handles" placeholder="@handle1&#10;@handle2"></textarea>
              <div class="helper">One handle per line or comma-separated.</div>
            </div>
            <div id="analyze-count-field">
              <label for="analyze-count">Top results</label>
              <input id="analyze-count" type="number" min="1" max="100" value="20" />
            </div>
            <div id="analyze-window-field">
              <label for="analyze-window">Time window</label>
              <select id="analyze-window">
                <option value="24h">Last 24h</option>
                <option value="7d">Last 7d</option>
                <option value="30d">Last 30d</option>
              </select>
            </div>
            <div id="analyze-outlier-field">
              <label for="analyze-outlier-toggle">Show outlier score</label>
              <input id="analyze-outlier-toggle" type="checkbox" checked />
            </div>
            <button id="analyze-button" type="submit">Fetch into Cache</button>
            <button id="save-handles-button" type="button" class="secondary">Save Handles</button>
          </form>
        </div>

        <div class="status" id="status">
          <span id="status-text">Ready.</span>
          <span class="spinner hidden" id="status-spinner" aria-hidden="true"></span>
        </div>

        <table>
          <thead>
            <tr>
              <th>Text</th>
              <th>Author</th>
              <th>Time</th>
              <th>Replies</th>
              <th>Retweets</th>
              <th>Likes</th>
              <th>Engagement</th>
              <th class="outlier-column">Outlier Score</th>
              <th>Link</th>
            </tr>
          </thead>
          <tbody id="results-body"></tbody>
        </table>
      </section>

      <section id="history-view" class="hidden">
        <div class="card">
          <h2>History Filters</h2>
          <form id="history-form" class="form-row">
            <div>
              <label for="history-start">Start</label>
              <input id="history-start" type="datetime-local" />
            </div>
            <div>
              <label for="history-end">End</label>
              <input id="history-end" type="datetime-local" />
            </div>
            <div>
              <label for="history-handle">Handle</label>
              <input id="history-handle" type="text" placeholder="@handle" />
            </div>
            <div>
              <label for="history-text">Text contains</label>
              <input id="history-text" type="text" placeholder="keyword" />
            </div>
            <div>
              <label for="history-min-likes">Min likes</label>
              <input id="history-min-likes" type="number" min="0" value="0" />
            </div>
            <div>
              <label for="history-min-retweets">Min retweets</label>
              <input id="history-min-retweets" type="number" min="0" value="0" />
            </div>
            <div>
              <label for="history-min-replies">Min replies</label>
              <input id="history-min-replies" type="number" min="0" value="0" />
            </div>
            <div>
              <label for="history-min-engagement">Min engagement</label>
              <input id="history-min-engagement" type="number" min="0" value="0" />
            </div>
            <div>
              <label for="history-source">Source</label>
              <select id="history-source">
                <option value="">All</option>
                <option value="handles">Handles</option>
                <option value="foryou">For You</option>
              </select>
            </div>
            <div>
              <label for="history-sort">Sort by</label>
              <select id="history-sort">
                <option value="createdAt">Date</option>
                <option value="retweets">Retweets</option>
                <option value="likes">Likes</option>
                <option value="replies">Replies</option>
                <option value="engagement">Engagement</option>
                <option value="outlier">Outlier</option>
              </select>
            </div>
            <div>
              <label for="history-sort-dir">Order</label>
              <select id="history-sort-dir">
                <option value="desc">Descending</option>
                <option value="asc">Ascending</option>
              </select>
            </div>
            <div>
              <label for="history-page-size">Page size</label>
              <input id="history-page-size" type="number" min="1" max="100" value="20" />
            </div>
            <button id="history-search" type="submit">Search History</button>
            <button id="history-reset" type="button" class="secondary">Reset</button>
          </form>
        </div>

        <div class="status" id="history-status">Ready.</div>

        <table>
          <thead>
            <tr>
              <th>Text</th>
              <th>Author</th>
              <th>Time</th>
              <th>Replies</th>
              <th>Retweets</th>
              <th>Likes</th>
              <th>Engagement</th>
              <th>Outlier Score</th>
              <th>Link</th>
            </tr>
          </thead>
          <tbody id="history-results-body"></tbody>
        </table>

        <div class="pagination">
          <div class="row">
            <button id="history-prev" type="button" class="secondary">Prev</button>
            <button id="history-next" type="button" class="secondary">Next</button>
          </div>
          <div class="page-info" id="history-page-info">Page 1</div>
        </div>
      </section>

      <section id="handles-view" class="hidden">
        <div class="card">
          <h2>Handles</h2>
          <div class="helper">Click a handle to view its history with filters.</div>
          <div class="grid" id="handles-grid"></div>
        </div>

        <div class="card">
          <h2>Handle History</h2>
          <form id="handles-history-form" class="form-row">
            <div>
              <label for="handles-history-handle">Handle</label>
              <input id="handles-history-handle" type="text" placeholder="@handle" />
            </div>
            <div>
              <label for="handles-history-start">Start</label>
              <input id="handles-history-start" type="datetime-local" />
            </div>
            <div>
              <label for="handles-history-end">End</label>
              <input id="handles-history-end" type="datetime-local" />
            </div>
            <div>
              <label for="handles-history-text">Text contains</label>
              <input id="handles-history-text" type="text" placeholder="keyword" />
            </div>
            <div>
              <label for="handles-history-min-likes">Min likes</label>
              <input id="handles-history-min-likes" type="number" min="0" value="0" />
            </div>
            <div>
              <label for="handles-history-min-retweets">Min retweets</label>
              <input id="handles-history-min-retweets" type="number" min="0" value="0" />
            </div>
            <div>
              <label for="handles-history-min-replies">Min replies</label>
              <input id="handles-history-min-replies" type="number" min="0" value="0" />
            </div>
            <div>
              <label for="handles-history-min-engagement">Min engagement</label>
              <input id="handles-history-min-engagement" type="number" min="0" value="0" />
            </div>
            <div>
              <label for="handles-history-page-size">Page size</label>
              <input id="handles-history-page-size" type="number" min="1" max="100" value="20" />
            </div>
            <button id="handles-history-search" type="submit">Search</button>
            <button id="handles-history-reset" type="button" class="secondary">Reset</button>
          </form>
        </div>

        <div class="status" id="handles-history-status">Ready.</div>

        <table>
          <thead>
            <tr>
              <th>Text</th>
              <th>Author</th>
              <th>Time</th>
              <th>Replies</th>
              <th>Retweets</th>
              <th>Likes</th>
              <th>Engagement</th>
              <th>Outlier Score</th>
              <th>Link</th>
              <th>Script</th>
            </tr>
          </thead>
          <tbody id="handles-history-results"></tbody>
        </table>

        <div class="pagination">
          <div class="row">
            <button id="handles-history-prev" type="button" class="secondary">Prev</button>
            <button id="handles-history-next" type="button" class="secondary">Next</button>
          </div>
          <div class="page-info" id="handles-history-page-info">Page 1</div>
        </div>
      </section>

      <section id="bird-view" class="hidden">
        <div class="card">
          <h2>Bird Search</h2>
          <div class="helper">Scan current AI, business, and tool conversations.</div>
          <div class="row" id="bird-presets">
            <button type="button" class="secondary" data-query="(ai OR artificial intelligence) (launch OR release OR research OR breakthrough)">
              AI
            </button>
            <button type="button" class="secondary" data-query="(business OR startup OR founder OR venture) (strategy OR growth OR revenue)">
              Business
            </button>
            <button type="button" class="secondary" data-query="(ai tools OR ai apps OR copilots OR agents) (product OR demo OR launch)">
              AI Tools & Apps
            </button>
          </div>
          <form id="bird-form" class="form-row">
            <div>
              <label for="bird-query">Custom query</label>
              <input id="bird-query" type="text" placeholder="keyword OR from:handle" />
            </div>
            <div>
              <label for="bird-count">Count</label>
              <input id="bird-count" type="number" min="1" max="100" value="20" />
            </div>
            <button id="bird-search-button" type="submit">Search</button>
          </form>
        </div>

        <div class="status" id="bird-status">Ready.</div>

        <table>
          <thead>
            <tr>
              <th>Text</th>
              <th>Author</th>
              <th>Time</th>
              <th>Replies</th>
              <th>Retweets</th>
              <th>Likes</th>
              <th>Engagement</th>
              <th>Link</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="bird-results-body"></tbody>
        </table>
      </section>

      <section id="foryou-view" class="hidden">
        <div class="card">
          <h2>For You Feed</h2>
          <div class="helper">Uses your X session cookies from .env (AUTH_TOKEN + CT0).</div>
          <form id="foryou-form" class="form-row">
            <div>
              <label for="foryou-count">Count</label>
              <input id="foryou-count" type="number" min="1" max="100" value="20" />
            </div>
            <button id="foryou-refresh" type="submit">Refresh</button>
            <button id="foryou-save" type="button" class="secondary">Run Daily Save</button>
            <button id="foryou-score" type="button" class="secondary">Score Top 20</button>
          </form>
        </div>

        <div class="status" id="foryou-status">Ready.</div>

        <table>
          <thead>
            <tr>
              <th>Text</th>
              <th>Author</th>
              <th>Time</th>
              <th>Replies</th>
              <th>Retweets</th>
              <th>Likes</th>
              <th>Engagement</th>
              <th>Link</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody id="foryou-results-body"></tbody>
        </table>
      </section>

      <section id="script-view" class="hidden">
        <div class="card">
          <h2>Script Generator</h2>
          <form id="script-form" class="form-row">
            <div>
              <label for="script-model">Model</label>
              <input
                id="script-model"
                type="text"
                placeholder="openrouter/anthropic/claude-3.5-sonnet"
              />
              <div class="helper">You can paste any OpenRouter model ID.</div>
            </div>
            <div>
              <label for="script-model-presets">Presets</label>
              <select id="script-model-presets">
                <option value="">Select preset</option>
                <option value="openrouter/anthropic/claude-3.5-sonnet">Claude 3.5 Sonnet</option>
                <option value="anthropic/claude-3.7-sonnet">Claude 3.7 Sonnet</option>
                <option value="moonshotai/kimi-k2.5">Kimi K2.5</option>
              </select>
            </div>
            <div>
              <label for="script-template-select">Template</label>
              <select id="script-template-select">
                <option value="">Select template</option>
              </select>
            </div>
            <div>
              <label for="script-template-name">Template name</label>
              <input id="script-template-name" type="text" placeholder="Reels Script v1" />
            </div>
            <div>
              <label for="script-template-content">Template content</label>
              <textarea id="script-template-content" placeholder="Template instructions..."></textarea>
            </div>
            <button id="script-save-template" type="button" class="secondary">Save Template</button>
            <div>
              <label for="script-prompt">Prompt</label>
              <textarea id="script-prompt" placeholder="Write a YouTube script that..."></textarea>
            </div>
            <button id="script-generate" type="submit">Generate Script</button>
            <button id="script-clear" type="button" class="secondary">Clear Selection</button>
          </form>
        </div>

        <div class="card">
          <h2>Selected Tweets</h2>
          <div class="helper">Tweets you add from Handles will appear here.</div>
          <div class="row">
            <div id="script-selection-list" class="row"></div>
            <button id="script-generate-inline" type="submit" form="script-form">Generate Script</button>
          </div>
        </div>

        <div class="card">
          <h2>Generated Scripts</h2>
          <div id="script-history" class="row"></div>
        </div>
      </section>

      <script src="app.js"></script>
    </div>
  </body>
</html>
